<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · QuantumGaussianDynamics.jl</title><meta name="title" content="API · QuantumGaussianDynamics.jl"/><meta property="og:title" content="API · QuantumGaussianDynamics.jl"/><meta property="twitter:title" content="API · QuantumGaussianDynamics.jl"/><meta name="description" content="Documentation for QuantumGaussianDynamics.jl."/><meta property="og:description" content="Documentation for QuantumGaussianDynamics.jl."/><meta property="twitter:description" content="Documentation for QuantumGaussianDynamics.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">QuantumGaussianDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li class="is-active"><a class="tocitem" href="api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="api.html">API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="api.html">API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.Dynamics" href="#QuantumGaussianDynamics.Dynamics"><code>QuantumGaussianDynamics.Dynamics</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Settings for the dynamics.</p><p>Dynamics(dt :: T = 1.0  #femtosecodns,     total<em>time :: T # In femtosecodns,     algorithm :: String = &quot;generalized-verlet&quot;,     kong</em>liu<em>ratio :: T = 1.0,     verbose :: Bool = true,     evolve</em>correlators :: Bool = true,     correlated :: Bool = true,     seed :: Int64,     N :: Int64,</p><pre><code class="nohighlight hljs"># Save the data each
save_each :: Int64 = 1,
save_filename :: String,
save_correlators :: Bool)</code></pre><p>The settings for the simulation. dt and total_time are in femtoseconds</p><ul><li><code>dt</code> is the time step [in femtoseconds]</li><li><code>total_time</code> is the total simulation time [in femtoseconds]</li><li><code>algorithm</code> is the integration algorithm to use. Either &quot;generalized-verlet&quot; or &quot;semi-implicit-verlet&quot;</li><li><code>kong_liu_ratio</code> is the ratio exploits the importance sampling.</li><li><code>verbose</code> is a flag to print out information during the simulation</li><li><code>evolve_correlators</code> is a flag to evolve the correlators &lt;RR&gt;, &lt;PP&gt; and &lt;RP&gt;</li><li><code>correlated</code> if true, the correlated approach for computing ensemble averages is used</li><li><code>seed</code> is the seed for the random number generator</li><li><code>N</code> is the number of stochastic configurations</li><li><code>save_filename</code> is the name of the file where to save the data</li><li><code>save_correlators</code> is a flag to save the correlators information</li><li><code>save_each</code> is the number of steps between each save of the data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/structures.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.ElectricField" href="#QuantumGaussianDynamics.ElectricField"><code>QuantumGaussianDynamics.ElectricField</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electric Field.</p><pre><code class="nohighlight hljs">Base.@kwdef mutable struct ElectricField{T &lt;: AbstractFloat} 
    fun :: Function #Time in fs, unit 
    Zeff :: Matrix{T} 
    edir :: Vector{T} #Must have unit norm
    eps :: Matrix{T}
end</code></pre><p>This structure contains the information about the external IR electric field.</p><ul><li><code>fun</code> is the function that describes the electric field as a function of time</li><li><code>Zeff</code> is the effective charge matrix</li><li><code>edir</code> is the direction of the electric field</li><li><code>eps</code> is the dielectric constant matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/structures.jl#L145-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.Ensemble" href="#QuantumGaussianDynamics.Ensemble"><code>QuantumGaussianDynamics.Ensemble</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Ensemble average information stocastic displacements and forces have index i, j, coordinate i, configuration j</p><p>Ensemble(rho0 :: WignerDistribution{T},     positions :: Matrix{T},  # Positions are multiplied by the square root of the masses     energies :: Vector{T},     forces :: Matrix{T}, # Forces are divided by the squareroot of masses     stress :: Matrix{T}, # Stress in eV/A^3     sscha<em>energies :: Vector{T},     sscha</em>forces :: Matrix{T},     n<em>configs :: Int32,     weights :: Vector{T},     temperature :: T,     correlated :: Bool,     y0 :: Matrix{T},     #unit</em>cell :: Matrix{T})</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/structures.jl#L109-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.calculate_ensemble!-Union{Tuple{T}, Tuple{Ensemble{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.calculate_ensemble!-Union{Tuple{T}, Tuple{Ensemble{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.calculate_ensemble!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate_ensemble!(ensemble::Ensemble{T}, crystal) where {T&lt;:AbstractFloat}</p><p>Evaluate energies, forces, and stresses for each configuration in an <code>Ensemble</code> using a given calculator ( assigned to <code>crystal</code>). Results are written back into the ensemble in place.</p><p><strong>Arguments</strong></p><ul><li><code>ensemble::Ensemble{T}</code>: ensemble of stochastic configurations. Updated in place.</li><li><code>crystal</code>: external calculator object (e.g. ASE/PyCall wrapper) providing:<ul><li><code>crystal.positions</code> (settable Cartesian coordinates)</li><li><code>get_potential_energy()</code></li><li><code>get_forces()</code> (returns <code>N_atoms × 3</code> array)</li><li><code>get_stress()</code> (returns stress tensor</li></ul></li></ul><p><strong>Units</strong></p><ul><li>Energies are converted to Rydberg (<code>* CONV_RY</code>).</li><li>Forces are flattened, divided by √masses, and converted with <code>CONV_RY/CONV_BOHR</code>.</li><li>Stress is assumed to be in eV/Å³ and stored directly.</li></ul><p><strong>Returns</strong></p><ul><li>The updated <code>ensemble</code> (modification is in place, return value is mainly for chaining).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L4-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.classic_evolution!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, T, Any, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.classic_evolution!-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, T, Any, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.classic_evolution!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>classic<em>evolution!(Rs::Vector{T}, Ps::Vector{T}, dt::T, cl</em>for, part) where {T &lt;: AbstractFloat}</p><p>Classic dynamics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L216-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.euler_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.euler_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.euler_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>euler<em>step!(wigner:: WignerDistribution{T}, dt :: T, avg</em>for :: Vector{T}, d2V_dr2 :: Matrix{T}) where {T &lt;: AbstractFloat}</p><p>Explicit Euler method. Implemented for testing and didactic use. MUST BE AVOIDED, it is unconditionally unstable. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L239-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.fixed_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.fixed_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.fixed_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function fixed<em>step!(wigner :: WignerDistribution{T}, dt :: T, avg</em>for :: Vector{T}, d2V_dr2 :: Matrix{T},part ) where {T &lt;: AbstractFloat}</p><p>Evolves the quantum state freezing the nuclear degrees of freedom. This corresponds to a classic evolution  in which however the forces are computed as ensemble averages using the initial quantum distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L188-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.full_generalized_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Vector{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.full_generalized_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Vector{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.full_generalized_verlet_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>semi<em>implicit</em>euler<em>step!(wigner:: WignerDistribution{T}, dt :: T, avg</em>for :: Vector{T}, d2V_dr2 :: Matrix{T}) where {T &lt;: AbstractFloat}</p><p>Experimental.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L313-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.generalized_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.generalized_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.generalized_verlet_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generalized_verlet_step!(rho :: WignerDistribution{T}, dt :: T, avg_for :: Vector{T}, d2V_dr2 :: Matrix{T}, bc0 :: Vector{T} ,part ) where {T &lt;: AbstractFloat}</code></pre><p>Evolves the means and second–order correlators of a <code>WignerDistribution</code> by one <strong>generalized-Verlet</strong> step. This is algorithm has O(dt^3) error in time step.  The algorithnm is illustrated in the work from Libbi et al., npj Computat. Mater. 11, 102 (2025), and consists of the explicit evolution of the variables ⟨R⟩, ⟨P⟩ and ⟨RR⟩, and of an implicit evolution for the variables ⟨PP⟩ and ⟨RP⟩. The latter is performed iteratively. </p><p><strong>Arguments</strong></p><ul><li><code>rho::WignerDistribution{T}</code>: state (means &amp; correlators), updated in place.</li><li><code>dt::T</code>: time step.</li><li><code>avg_for::Vector{T}</code>: current average force ⟨f⟩.</li><li><code>d2V_dr2::Matrix{T}</code>: Hessian (∂²V). Assumed symmetric in practice.</li><li><code>part::Int</code>: stage selector (<code>1</code> = predictor, <code>2</code> = corrector).</li></ul><p>Given the following variables name ⟨R⟩   = R<em>av, ⟨P⟩   = P</em>av, ⟨f⟩   = avg<em>for, ⟨RR⟩  = RR</em>corr, ⟨PP⟩  = PP<em>corr, ⟨RP⟩  = RP</em>corr, ⟨d²V⟩ = d2V_dr2</p><ul><li><p><code>part == 1</code> (predictor):</p><ul><li>Means (half-kick)<ul><li>⟨R⟩ ← ⟨R⟩ + dt<em>⟨P⟩ + ½</em>dt²*⟨f⟩</li><li>⟨P⟩ ← ⟨P⟩ + ½<em>dt</em>⟨f⟩</li></ul></li><li>Correlators<ul><li>let  K = ⟨RR⟩ * ⟨d²V⟩</li><li>⟨RR⟩ ← ⟨RR⟩ + dt<em>(⟨RP⟩ + ⟨RP⟩ᵀ) − ½</em>dt²<em>(K + Kᵀ) + dt²</em>⟨PP⟩</li><li>save ⟨RP⟩₀ = ⟨RP⟩</li><li>⟨RP⟩ ← ⟨RP⟩ + ½<em>dt</em>(⟨PP⟩ − K)</li><li>⟨PP⟩ ← ⟨PP⟩ − ½<em>dt</em>(⟨d²V⟩<em>⟨RP⟩₀ + (⟨d²V⟩</em>⟨RP⟩₀)ᵀ)</li></ul></li></ul></li><li><p><code>part == 2</code> (corrector / finishing kick):</p><ul><li>Means<ul><li>⟨P⟩ ← ⟨P⟩ + ½<em>dt</em>⟨f⟩</li></ul></li><li>Correlators (fixed-point refinement of ⟨PP⟩ and ⟨RP⟩)<ul><li>pre-update: ⟨RP⟩ ← ⟨RP⟩ − ½<em>dt</em>(⟨RR⟩*⟨d²V⟩)</li><li>iterate a few times (typically 4):<ul><li>⟨RP⟩₁ ← ⟨RP⟩ + ½<em>dt</em>⟨PP⟩₁</li><li>⟨PP⟩₁ ← ⟨PP⟩ − ½<em>dt</em>(⟨d²V⟩<em>⟨RP⟩₁ + (⟨d²V⟩</em>⟨RP⟩₁)ᵀ)</li></ul></li><li>write back final ⟨PP⟩, ⟨RP⟩</li></ul></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L85-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.generate_ensemble!-Union{Tuple{T}, Tuple{Any, Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.generate_ensemble!-Union{Tuple{T}, Tuple{Any, Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.generate_ensemble!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_ensemble!(N, ensemble:: Ensemble{T}, wigner_distribution :: WignerDistribution{T}) where {T &lt;: AbstractFloat}</code></pre><p>Generate or update an ensemble of stochastic configurations for nuclear dynamics, based on a Wigner distribution.</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Number of configurations to generate (must be even).</li><li><code>ensemble::Ensemble{T}</code>: Target ensemble structure. Arrays are either updated in place if their size already matches <code>N</code>, or reallocated otherwise.</li><li><code>wigner_distribution::WignerDistribution{T}</code>: Wigner distribution that encodes the covariance matrices, eigenvalues, and eigenvectors used to generate the ensemble.</li></ul><p><strong>Behavior</strong></p><ul><li>If <code>ensemble.correlated == true</code>, correlated configurations are generated from <code>ensemble.y0</code> using the square root of the correlator matrix.</li><li>Otherwise, random Gaussian vectors are drawn (using <code>randn</code>) and scaled by <code>√λ</code> or <code>1/√λ</code> depending on whether <code>ρ.evolve_correlators</code> is set.</li><li>In MPI runs, random numbers are generated on rank 0 and broadcast to all ranks so that every processor works with the same ensemble.</li></ul><p><strong>Returns</strong></p><ul><li>The updated <code>ensemble</code> (modifications are in place).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L192-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_average_energy-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_average_energy-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_average_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_average_energy(ensemble :: Ensemble{T}) where {T &lt;: AbstractFloat}</code></pre><p>Computes the ensemble average of the potential energy. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L399-L404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_average_forces-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_average_forces-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_average_forces</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_average_forces(ensemble :: Ensemble{T}) where {T &lt;: AbstractFloat}</code></pre><p>Computes the ensemble average of the forces. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L418-L423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_average_stress-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_average_stress-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_average_stress</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_average_stress(ensemble :: Ensemble{T}, wigner :: WignerDistribution{T}) where {T &lt;: AbstractFloat}</code></pre><p>Computes the ensemble average of the stress.  The result is returned in Ry/Bohr^3</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L432-L438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_averages!-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_averages!-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_averages!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function get<em>averages!(avg</em>for :: Vector{T}, d2v<em>dr2 :: Matrix{T}, ensemble :: Ensemble{T}, wigner</em>distribution :: WignerDistribution{T}) where {T &lt;: AbstractFloat}</p><p>Evaluate the average force and d2v_dr2 from the ensemble and the wigner distribution. The weights on the ensemble should have been already updated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L481-L487">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_classic_forces-Union{Tuple{T}, Tuple{WignerDistribution{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_classic_forces-Union{Tuple{T}, Tuple{WignerDistribution{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_classic_forces</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_classic_forces(wigner_distribution:: WignerDistribution{T}, crystal) where {T &lt;: AbstractFloat}</code></pre><p>Compute the forces at the centroids, i.e., the classical forces acting on the crystal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L111-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_kong_liu-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_kong_liu-Union{Tuple{Ensemble{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_kong_liu</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kong_liu(ensemble :: Ensemble{T}) where {T &lt;: AbstractFloat}</code></pre><p>Compute the Kong-Liu ration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L150-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_random_y-Union{Tuple{T}, Tuple{Any, Any, Dynamics{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_random_y-Union{Tuple{T}, Tuple{Any, Any, Dynamics{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_random_y</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_random_y(N, N_modes, settings :: Dynamics{T}) where {T &lt;: AbstractFloat}</code></pre><p>Generates a random matrix of numbers sampled from a normal distribution. Each row corresponds to a phonon mode, and contains N random configurations (or N/2 if even<em>odd = true). For parallel execution, the matrix ymu</em>i is broadcast so that all processors use the same random variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L161-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_total_energy-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_total_energy-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_total_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_total_energy(ensemble :: Ensemble{T}, wigner_distribution :: WignerDistribution{T}) where {T &lt;: AbstractFloat}</code></pre><p>Computes the total quantum energy, as a sum of the quantum potential energy (avg<em>ene), quantum kynetic energy (K</em>rho), and classic kynetic energy (K_point)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L380-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.get_λs-Union{Tuple{Matrix{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.get_λs-Union{Tuple{Matrix{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.get_λs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function get_λs(RR_corr :: Matrix{T}) where {T &lt;: AbstractFloat}</code></pre><p>Get the eigenvalues of &lt;RR&gt;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L640-L646">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.init_ensemble_from_python-Union{Tuple{T}, Tuple{Any, Dynamics{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.init_ensemble_from_python-Union{Tuple{T}, Tuple{Any, Dynamics{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.init_ensemble_from_python</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_ensemble_from_python(py_ensemble, settings::Dynamics{T}) where {T&lt;:AbstractFloat}</code></pre><p>Construct a Julia <code>Ensemble</code> object from a Python-side ensemble exported via PyCall.</p><p>This routine converts positions, forces, stresses, and energies from the Python <code>py_ensemble</code> (typically created by CellConstructor / SSCHA Python codes) into the internal representation used by <code>QuantumGaussianDynamics</code>.</p><p><strong>Arguments</strong></p><ul><li><code>py_ensemble</code>: A Python object with fields:<ul><li><code>current_dyn</code>    – Python dynamical matrix object</li><li><code>T0</code>             – temperature (in K)</li><li><code>N</code>              – number of configurations</li><li><code>xats</code>           – atomic random displacements, shape (N, Nat, 3)</li><li><code>energies</code>       – raw energies for each configuration</li><li><code>sscha_energies</code> – SSCHA energies</li><li><code>forces</code>         – atomic forces, shape (N, Nat, 3)</li><li><code>sscha_forces</code>   – SSCHA forces, shape (N, Nat, 3)</li><li><code>stresses</code>       – stress tensors, shape (N, 3, 3)</li></ul></li></ul><p><strong>Conversions performed</strong></p><ul><li><strong>Positions</strong>: <code>(Nat, 3, N)</code> → <code>(3*Nat, N)</code>. Converted to Bohr and multiplied by √masses.</li><li><strong>Energies</strong>: copied directly from <code>py_ensemble.energies</code> and <code>sscha_energies</code>.</li><li><strong>Forces</strong>: <code>(Nat, 3, N)</code> → <code>(3*Nat, N)</code>. Converted to Ry/Bohr and divided by √masses.</li><li><strong>Stresses</strong>: <code>(3,3)</code> tensors packed into 6×N Voigt form:   1=xx, 2=yy, 3=zz, 4=yz, 5=xz, 6=xy.</li><li><strong>Weights</strong>: initialized to 1.0 for all configurations.</li><li><strong>Random seed</strong>: if <code>settings.seed != 0</code>, reseeds RNG for reproducibility.</li><li><strong>y0</strong>: initial random Gaussian vectors, generated with <code>get_random_y</code>. If <code>settings.correlated==false</code>, filled with zeros of the correct shape.</li></ul><p><strong>Returns</strong></p><ul><li><code>Ensemble{T}</code>: A new ensemble populated with data from Python, ready for use in QuantumGaussianDynamics simulations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L525-L562">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.init_from_dyn-Union{Tuple{T}, Tuple{Any, T, Dynamics{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.init_from_dyn-Union{Tuple{T}, Tuple{Any, T, Dynamics{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.init_from_dyn</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_from_dyn(dyn, TEMPERATURE::T, settings::Dynamics{T}) where {T&lt;:AbstractFloat}</code></pre><p>Initialize a <code>WignerDistribution</code> object starting from a dynamical matrix.</p><p>This routine constructs the equilibrium nuclear quantum state (in terms of positions, momenta, and correlation matrices) associated with the phonon modes of the provided dynamical matrix at a given temperature.</p><p><strong>Arguments</strong></p><ul><li><code>dyn</code>: A dynamical matrix object from SSCHA calculations</li><li><code>TEMPERATURE::T</code>: The target temperature.</li><li><code>settings::Dynamics{T}</code>: Simulation settings.</li></ul><p><strong>Details</strong></p><ul><li>Builds a supercell from <code>dyn</code> and computes the number of modes and atoms.</li><li>Diagonalizes the supercell dynamical matrix to obtain phonon frequencies and eigenvectors (polarizations).</li><li>Computes Gaussian width parameters (<code>alpha</code>, <code>beta</code>) and correlators (<code>RR_corr</code>, <code>PP_corr</code>, <code>RP_corr</code>) at the specified temperature.</li><li>Initializes average positions (<code>R_av</code>) and momenta (<code>P_av</code>), rescaled by atomic masses.</li><li>Removes translational acoustic modes from the correlators/eigenvalues.</li></ul><p><strong>Returns</strong></p><ul><li><code>rho::WignerDistribution</code>: An initialized Wigner distribution representing the quantum nuclear state corresponding to the given dynamical matrix and temperature.</li></ul><p><strong>Notes</strong></p><ul><li>Frequencies are assumed to be in Rydberg units.</li><li>Cell vectors and coordinates are converted to Bohr units.</li><li>If <code>settings.evolve_correlators == false</code>, eigen-decomposition of <code>alpha</code> is used; otherwise, the <code>RR_corr</code> matrix is diagonalized (deprecated).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/wigner.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.integrate!-Union{Tuple{T}, Tuple{WignerDistribution{T}, Ensemble{T}, Dynamics{T}, Any, ElectricField{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.integrate!-Union{Tuple{T}, Tuple{WignerDistribution{T}, Ensemble{T}, Dynamics{T}, Any, ElectricField{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.integrate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate!(wigner::WignerDistribution{T},
           ensemble::Ensemble{T},
           settings::Dynamics{T},
           crystal,
           efield::ElectricField{T}) where {T&lt;:AbstractFloat}</code></pre><p>Time-integrate the TDSCHA equations of motion. This mutates <code>wigner</code> (⟨R⟩, ⟨P⟩, correlators) and <code>ensemble</code> (weights, possibly regenerated configurations), and writes diagnostics to disk at the cadence <code>settings.save_each</code>.</p><p><strong>Integration scheme</strong></p><ul><li>Uses the algorithm specified by <code>settings.algorithm</code>: <code>&quot;euler&quot; | &quot;semi-implicit-euler&quot; | &quot;semi-implicit-verlet&quot; | &quot;fixed&quot; | &quot;generalized-verlet&quot; | &quot;none&quot;</code>.</li><li>At each step:<ol><li>Build average force and Hessian‐like term from the current ensemble: <code>get_averages!</code>.</li><li>Add external field forces <code>get_external_forces(t_fs, efield, wigner)</code>.</li><li>Advance quantum variables with the selected integrator.</li><li>Advance classical centroids <code>(Rs, Ps)</code> via <code>classic_evolution!</code>.</li><li>Update eigenstructure of <code>RR</code> and reweight the ensemble <code>update_weights!</code>.</li><li>If the Kong–Liu ratio falls below <code>settings.kong_liu_ratio</code>, regenerate the ensemble and recompute forces.</li></ol></li></ul><p><strong>Files written (rank 0 only)</strong></p><p>All prefixed by <code>settings.save_filename * &quot;settings.dt-settings.total_time-settings.N&quot;</code>: All in Rydberg units, NOT scaled by masses. </p><ul><li><code>.pos</code>: ⟨R⟩ and ⟨P⟩ plus total energy.</li><li><code>.rho</code>: RR correlator.</li><li><code>.for</code>: average force and “classical” force, and <code>d²V/dR²</code>.</li><li><code>.cl</code>: classical centroids and classical energy.</li><li><code>.ext</code>: external field force.</li><li><code>.str</code>: average Voigt stress.</li><li><code>.bet</code>: PP correlator.</li><li><code>.gam</code>: RP correlator.</li></ul><p><strong>Returns</strong></p><p><code>nothing</code>. The function mutates <code>wigner</code>, <code>ensemble</code>, and writes output files.</p><p><strong>Errors</strong></p><p>Throws <code>ArgumentError</code> if <code>settings.algorithm</code> is unknown.</p><p><strong>Example</strong></p><p>```julia w   = WignerDistribution{Float64}(; ... )   # prepared from a phonon dyn ens = Ensemble{Float64}(; ... )             # configurations &amp; weights ef  = ElectricField{Float64}(; fun=t-&gt;exp(-(t-50)^2/200), Zeff=Z, edir=û, eps=ϵ) integrate!(w, ens, Dynamics(dt=1.0, total<em>time=200.0, algorithm=&quot;generalized-verlet&quot;,                             kong</em>liu<em>ratio=0.8, verbose=true, correlated=true,                             seed=1, N=size(ens.positions,2), save</em>each=50,                             save_filename=&quot;run&quot;), crystal, ef)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/dynamics.jl#L1-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.pulse-NTuple{5, Any}" href="#QuantumGaussianDynamics.pulse-NTuple{5, Any}"><code>QuantumGaussianDynamics.pulse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pulse(t, A, w, t0, sig)</code></pre><p>Gaussian wavepacket pulse</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/external_f.jl#L108-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.remove_translations-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, T}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.remove_translations-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T}, T}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.remove_translations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Remove acoustic sum rule from eigenvalue and eigenvectors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/wigner.jl#L106-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.semi_implicit_euler_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.semi_implicit_euler_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.semi_implicit_euler_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>semi<em>implicit</em>euler<em>step!(wigner:: WignerDistribution{T}, dt :: T, avg</em>for :: Vector{T}, d2V_dr2 :: Matrix{T}) where {T &lt;: AbstractFloat}</p><p>Semi-implicit Euler method. Implemented for testing and didactic use. Not efficient, use semi-implicit Verlet instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L276-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.semi_implicit_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.semi_implicit_verlet_step!-Union{Tuple{T}, Tuple{WignerDistribution{T}, T, Vector{T}, Matrix{T}, Any}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.semi_implicit_verlet_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function semi_implicit_verlet_step!(rho:: WignerDistribution{T}, dt :: T, avg_for :: Vector{T}, d2V_dr2 :: Matrix{T}, part ) where {T &lt;: AbstractFloat}</code></pre><p>Evolves the quantum means and correlators of a <code>WignerDistribution</code> by one semi-implicit Verlet integration step. This algorithms has error O(dt^2) on  the integration of the correlators. </p><p>This is a two-stage scheme:  </p><ul><li><code>part == 1</code> updates the positions (<code>R_av</code>) and momenta (<code>P_av</code>) using the current force <code>avg_for</code>.  </li><li><code>part == 2</code> completes the step with the updated force, and evolves the second-order correlators (<code>RR_corr</code>, <code>RP_corr</code>, <code>PP_corr</code>).</li></ul><p><strong>Arguments</strong></p><ul><li><code>ρ::WignerDistribution{T}</code>: system state (means and correlators), mutated in place.</li><li><code>dt::T</code>: time step.</li><li><code>avg_for::Vector{T}</code>: average force vector ⟨F⟩.</li><li><code>d2V_dr2::Matrix{T}</code>: Hessian (second derivatives of the potential).</li><li><code>part::Int</code>: integration stage:</li></ul><p><strong>Method</strong></p><p>Given the following variables name ⟨R⟩   = R<em>av, ⟨P⟩   = P</em>av, ⟨f⟩   = avg<em>for, ⟨RR⟩  = RR</em>corr, ⟨PP⟩  = PP<em>corr, ⟨RP⟩  = RP</em>corr, ⟨d²V⟩ = d2V_dr2</p><ul><li>In part == 1:<ul><li>⟨R⟩ ← ⟨R⟩ + dt·⟨P⟩ + ½·dt²·⟨f⟩</li><li>⟨P⟩ ← ⟨P⟩ + ½·dt·⟨f⟩</li></ul></li><li>In part == 2:<ul><li>⟨P⟩ ← ⟨P⟩ + ½·dt·⟨f⟩</li><li>⟨RP⟩ ← ⟨RP⟩ + dt·⟨PP⟩ − dt·⟨RR⟩·⟨d²V⟩</li><li>⟨PP⟩ ← ⟨PP⟩ − dt·(⟨d²V⟩·⟨RP⟩ + (⟨d²V⟩·⟨RP⟩)ᵀ)</li><li>⟨RR⟩ ← ⟨RR⟩ + dt·(⟨RP⟩ + ⟨RP⟩ᵀ)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/time_evolution.jl#L8-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.sin_field-Tuple{Any, Any, Any}" href="#QuantumGaussianDynamics.sin_field-Tuple{Any, Any, Any}"><code>QuantumGaussianDynamics.sin_field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sin_field(t, A, w)</code></pre><p>Sinusoidal external field. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/external_f.jl#L93-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumGaussianDynamics.update_weights!-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat" href="#QuantumGaussianDynamics.update_weights!-Union{Tuple{T}, Tuple{Ensemble{T}, WignerDistribution{T}}} where T&lt;:AbstractFloat"><code>QuantumGaussianDynamics.update_weights!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update the weights of the ensemble according with the new wigner distribution</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NonequilibriumQuantumGaussianDynamics/QuantumGaussianDynamics.jl/blob/8417b8853f6bb71f3050ba732c20fa9addcb3f2d/src/ensemble.jl#L318-L320">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 25 October 2025 21:03">Saturday 25 October 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
